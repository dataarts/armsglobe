/*! dataglobe 24-09-2015 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){"use strict";var c={linear:function(a,b,c,d){var e=c-b;return a*e/d+b},easeInQuad:function(a,b,c,d){var e=c-b;return e*(a/=d)*a+b},easeOutQuad:function(a,b,c,d){var e=c-b;return-e*(a/=d)*(a-2)+b},easeInOutQuad:function(a,b,c,d){var e=c-b;return(a/=d/2)<1?e/2*a*a+b:-e/2*(--a*(a-2)-1)+b},easeInElastic:function(a,b,c,d){var e=c-b,f=1.70158,g=0,h=e;if(0==a)return b;if(1==(a/=d))return b+e;if(g||(g=.3*d),h<Math.abs(e)){h=e;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(e/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/g))+b},easeOutElastic:function(a,b,c,d){var e=c-b,f=1.70158,g=0,h=e;if(0==a)return b;if(1==(a/=d))return b+e;if(g||(g=.3*d),h<Math.abs(e)){h=e;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(e/h);return h*Math.pow(2,-10*a)*Math.sin(2*(a*d-f)*Math.PI/g)+e+b},easeInOutElastic:function(a,b,c,d){var e=c-b,f=1.70158,g=0,h=e;if(0==a)return b;if(2==(a/=d/2))return b+e;if(g||(g=.3*d*1.5),h<Math.abs(e)){h=e;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(e/h);return 1>a?-.5*h*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/g)+b:h*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/g)*.5+e+b},easeInBack:function(a,b,c,d,e){var f=c-b;return void 0==e&&(e=1.70158),f*(a/=d)*a*((e+1)*a-e)+b},easeOutBack:function(a,b,c,d,e){var f=c-b;return void 0==e&&(e=1.70158),f*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOutBack:function(a,b,c,d,e){var f=c-b;return void 0==e&&(e=1.70158),(a/=d/2)<1?f/2*a*a*(((e*=1.525)+1)*a-e)+b:f/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b},easeInBounce:function(a,b,d,e){var f=d-b;return f-c.easeOutBounce(e-a,0,f,e)+b},easeOutBounce:function(a,b,c,d){var e=c-b;return(a/=d)<1/2.75?7.5625*e*a*a+b:2/2.75>a?e*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?e*(7.5625*(a-=2.25/2.75)*a+.9375)+b:e*(7.5625*(a-=2.625/2.75)*a+.984375)+b},easeInOutBounce:function(a,b,d,e){var f=d-b;return e/2>a?.5*c.easeInBounce(2*a,0,f,e)+b:.5*c.easeOutBounce(2*a-e,0,f,e)+.5*f+b}};b.exports=c},{}],2:[function(a,b){"use strict";function c(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function d(a){return a}var e=a("./easingTypes"),f="ADDITIVE",g=e.easeInOutQuad,h=300,i=0,j={easingTypes:e,stackBehavior:{ADDITIVE:"ADDITIVE",DESTRUCTIVE:"DESTRUCTIVE"}};j.Mixin={getInitialState:function(){return{tweenQueue:[]}},tweenState:function(a,b,c){"string"==typeof a&&(c=b,b=a,a=d),this._tweenState(a,b,c)},_tweenState:function(a,b,d){d=c(d);var e=this._pendingState||this.state,k=a(e);d.stackBehavior=d.stackBehavior||f,d.easing=d.easing||g,d.duration=null==d.duration?h:d.duration,d.beginValue=null==d.beginValue?k[b]:d.beginValue,d.delay=null==d.delay?i:d.delay;var l=e.tweenQueue;d.stackBehavior===j.stackBehavior.DESTRUCTIVE&&(l=e.tweenQueue.filter(function(a){return a.stateName!==b||a.stateRefFunc(e)!==k})),l.push({stateRefFunc:a,stateName:b,config:d,initTime:Date.now()+d.delay}),k[b]=d.endValue,this.setState({tweenQueue:l}),1===l.length&&this.startRaf()},getTweeningValue:function(a,b){return"string"==typeof a&&(b=a,a=d),this._getTweeningValue(a,b)},_getTweeningValue:function(a,b){for(var c=this.state,d=a(c),e=d[b],f=Date.now(),g=0;g<c.tweenQueue.length;g++){var h=c.tweenQueue[g],i=h.stateRefFunc(c);if(h.stateName===b&&i===d){var j=f-h.initTime>h.config.duration?h.config.duration:Math.max(0,f-h.initTime),k=-h.config.endValue+h.config.easing(j,h.config.beginValue,h.config.endValue,h.config.duration);e+=k}}return e},_rafCb:function(){if(this.isMounted()){var a=this.state;if(0!==a.tweenQueue.length){var b=Date.now();a.tweenQueue.forEach(function(a){b-a.initTime>=a.config.duration&&a.config.onEnd&&a.config.onEnd()});var c=a.tweenQueue.filter(function(a){return b-a.initTime<a.config.duration});this.setState({tweenQueue:c}),requestAnimationFrame(this._rafCb)}}},startRaf:function(){requestAnimationFrame(this._rafCb)}},b.exports=j},{"./easingTypes":1}],3:[function(a,b,c){(function(){function a(a){function b(b,c,d,e,f,g){for(;f>=0&&g>f;f+=a){var h=e?e[f]:f;d=c(d,b[h],h,b)}return d}return function(c,d,e,f){d=v(d,f,4);var g=!C(c)&&u.keys(c),h=(g||c).length,i=a>0?0:h-1;return arguments.length<3&&(e=c[g?g[i]:i],i+=a),b(c,d,e,g,i,h)}}function d(a){return function(b,c,d){c=w(c,d);for(var e=B(b),f=a>0?0:e-1;f>=0&&e>f;f+=a)if(c(b[f],f,b))return f;return-1}}function e(a,b,c){return function(d,e,f){var g=0,h=B(d);if("number"==typeof f)a>0?g=f>=0?f:Math.max(f+h,g):h=f>=0?Math.min(f+1,h):f+h+1;else if(c&&f&&h)return f=c(d,e),d[f]===e?f:-1;if(e!==e)return f=b(m.call(d,g,h),u.isNaN),f>=0?f+g:-1;for(f=a>0?g:h-1;f>=0&&h>f;f+=a)if(d[f]===e)return f;return-1}}function f(a,b){var c=H.length,d=a.constructor,e=u.isFunction(d)&&d.prototype||j,f="constructor";for(u.has(a,f)&&!u.contains(b,f)&&b.push(f);c--;)f=H[c],f in a&&a[f]!==e[f]&&!u.contains(b,f)&&b.push(f)}var g=this,h=g._,i=Array.prototype,j=Object.prototype,k=Function.prototype,l=i.push,m=i.slice,n=j.toString,o=j.hasOwnProperty,p=Array.isArray,q=Object.keys,r=k.bind,s=Object.create,t=function(){},u=function(a){return a instanceof u?a:this instanceof u?void(this._wrapped=a):new u(a)};"undefined"!=typeof c?("undefined"!=typeof b&&b.exports&&(c=b.exports=u),c._=u):g._=u,u.VERSION="1.8.3";var v=function(a,b,c){if(void 0===b)return a;switch(null==c?3:c){case 1:return function(c){return a.call(b,c)};case 2:return function(c,d){return a.call(b,c,d)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)}}return function(){return a.apply(b,arguments)}},w=function(a,b,c){return null==a?u.identity:u.isFunction(a)?v(a,b,c):u.isObject(a)?u.matcher(a):u.property(a)};u.iteratee=function(a,b){return w(a,b,1/0)};var x=function(a,b){return function(c){var d=arguments.length;if(2>d||null==c)return c;for(var e=1;d>e;e++)for(var f=arguments[e],g=a(f),h=g.length,i=0;h>i;i++){var j=g[i];b&&void 0!==c[j]||(c[j]=f[j])}return c}},y=function(a){if(!u.isObject(a))return{};if(s)return s(a);t.prototype=a;var b=new t;return t.prototype=null,b},z=function(a){return function(b){return null==b?void 0:b[a]}},A=Math.pow(2,53)-1,B=z("length"),C=function(a){var b=B(a);return"number"==typeof b&&b>=0&&A>=b};u.each=u.forEach=function(a,b,c){b=v(b,c);var d,e;if(C(a))for(d=0,e=a.length;e>d;d++)b(a[d],d,a);else{var f=u.keys(a);for(d=0,e=f.length;e>d;d++)b(a[f[d]],f[d],a)}return a},u.map=u.collect=function(a,b,c){b=w(b,c);for(var d=!C(a)&&u.keys(a),e=(d||a).length,f=Array(e),g=0;e>g;g++){var h=d?d[g]:g;f[g]=b(a[h],h,a)}return f},u.reduce=u.foldl=u.inject=a(1),u.reduceRight=u.foldr=a(-1),u.find=u.detect=function(a,b,c){var d;return d=C(a)?u.findIndex(a,b,c):u.findKey(a,b,c),void 0!==d&&-1!==d?a[d]:void 0},u.filter=u.select=function(a,b,c){var d=[];return b=w(b,c),u.each(a,function(a,c,e){b(a,c,e)&&d.push(a)}),d},u.reject=function(a,b,c){return u.filter(a,u.negate(w(b)),c)},u.every=u.all=function(a,b,c){b=w(b,c);for(var d=!C(a)&&u.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(!b(a[g],g,a))return!1}return!0},u.some=u.any=function(a,b,c){b=w(b,c);for(var d=!C(a)&&u.keys(a),e=(d||a).length,f=0;e>f;f++){var g=d?d[f]:f;if(b(a[g],g,a))return!0}return!1},u.contains=u.includes=u.include=function(a,b,c,d){return C(a)||(a=u.values(a)),("number"!=typeof c||d)&&(c=0),u.indexOf(a,b,c)>=0},u.invoke=function(a,b){var c=m.call(arguments,2),d=u.isFunction(b);return u.map(a,function(a){var e=d?b:a[b];return null==e?e:e.apply(a,c)})},u.pluck=function(a,b){return u.map(a,u.property(b))},u.where=function(a,b){return u.filter(a,u.matcher(b))},u.findWhere=function(a,b){return u.find(a,u.matcher(b))},u.max=function(a,b,c){var d,e,f=-(1/0),g=-(1/0);if(null==b&&null!=a){a=C(a)?a:u.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],d>f&&(f=d)}else b=w(b,c),u.each(a,function(a,c,d){e=b(a,c,d),(e>g||e===-(1/0)&&f===-(1/0))&&(f=a,g=e)});return f},u.min=function(a,b,c){var d,e,f=1/0,g=1/0;if(null==b&&null!=a){a=C(a)?a:u.values(a);for(var h=0,i=a.length;i>h;h++)d=a[h],f>d&&(f=d)}else b=w(b,c),u.each(a,function(a,c,d){e=b(a,c,d),(g>e||e===1/0&&f===1/0)&&(f=a,g=e)});return f},u.shuffle=function(a){for(var b,c=C(a)?a:u.values(a),d=c.length,e=Array(d),f=0;d>f;f++)b=u.random(0,f),b!==f&&(e[f]=e[b]),e[b]=c[f];return e},u.sample=function(a,b,c){return null==b||c?(C(a)||(a=u.values(a)),a[u.random(a.length-1)]):u.shuffle(a).slice(0,Math.max(0,b))},u.sortBy=function(a,b,c){return b=w(b,c),u.pluck(u.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var D=function(a){return function(b,c,d){var e={};return c=w(c,d),u.each(b,function(d,f){var g=c(d,f,b);a(e,d,g)}),e}};u.groupBy=D(function(a,b,c){u.has(a,c)?a[c].push(b):a[c]=[b]}),u.indexBy=D(function(a,b,c){a[c]=b}),u.countBy=D(function(a,b,c){u.has(a,c)?a[c]++:a[c]=1}),u.toArray=function(a){return a?u.isArray(a)?m.call(a):C(a)?u.map(a,u.identity):u.values(a):[]},u.size=function(a){return null==a?0:C(a)?a.length:u.keys(a).length},u.partition=function(a,b,c){b=w(b,c);var d=[],e=[];return u.each(a,function(a,c,f){(b(a,c,f)?d:e).push(a)}),[d,e]},u.first=u.head=u.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:u.initial(a,a.length-b)},u.initial=function(a,b,c){return m.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))},u.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:u.rest(a,Math.max(0,a.length-b))},u.rest=u.tail=u.drop=function(a,b,c){return m.call(a,null==b||c?1:b)},u.compact=function(a){return u.filter(a,u.identity)};var E=function(a,b,c,d){for(var e=[],f=0,g=d||0,h=B(a);h>g;g++){var i=a[g];if(C(i)&&(u.isArray(i)||u.isArguments(i))){b||(i=E(i,b,c));var j=0,k=i.length;for(e.length+=k;k>j;)e[f++]=i[j++]}else c||(e[f++]=i)}return e};u.flatten=function(a,b){return E(a,b,!1)},u.without=function(a){return u.difference(a,m.call(arguments,1))},u.uniq=u.unique=function(a,b,c,d){u.isBoolean(b)||(d=c,c=b,b=!1),null!=c&&(c=w(c,d));for(var e=[],f=[],g=0,h=B(a);h>g;g++){var i=a[g],j=c?c(i,g,a):i;b?(g&&f===j||e.push(i),f=j):c?u.contains(f,j)||(f.push(j),e.push(i)):u.contains(e,i)||e.push(i)}return e},u.union=function(){return u.uniq(E(arguments,!0,!0))},u.intersection=function(a){for(var b=[],c=arguments.length,d=0,e=B(a);e>d;d++){var f=a[d];if(!u.contains(b,f)){for(var g=1;c>g&&u.contains(arguments[g],f);g++);g===c&&b.push(f)}}return b},u.difference=function(a){var b=E(arguments,!0,!0,1);return u.filter(a,function(a){return!u.contains(b,a)})},u.zip=function(){return u.unzip(arguments)},u.unzip=function(a){for(var b=a&&u.max(a,B).length||0,c=Array(b),d=0;b>d;d++)c[d]=u.pluck(a,d);return c},u.object=function(a,b){for(var c={},d=0,e=B(a);e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},u.findIndex=d(1),u.findLastIndex=d(-1),u.sortedIndex=function(a,b,c,d){c=w(c,d,1);for(var e=c(b),f=0,g=B(a);g>f;){var h=Math.floor((f+g)/2);c(a[h])<e?f=h+1:g=h}return f},u.indexOf=e(1,u.findIndex,u.sortedIndex),u.lastIndexOf=e(-1,u.findLastIndex),u.range=function(a,b,c){null==b&&(b=a||0,a=0),c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=Array(d),f=0;d>f;f++,a+=c)e[f]=a;return e};var F=function(a,b,c,d,e){if(!(d instanceof b))return a.apply(c,e);var f=y(a.prototype),g=a.apply(f,e);return u.isObject(g)?g:f};u.bind=function(a,b){if(r&&a.bind===r)return r.apply(a,m.call(arguments,1));if(!u.isFunction(a))throw new TypeError("Bind must be called on a function");var c=m.call(arguments,2),d=function(){return F(a,d,b,this,c.concat(m.call(arguments)))};return d},u.partial=function(a){var b=m.call(arguments,1),c=function(){for(var d=0,e=b.length,f=Array(e),g=0;e>g;g++)f[g]=b[g]===u?arguments[d++]:b[g];for(;d<arguments.length;)f.push(arguments[d++]);return F(a,c,this,this,f)};return c},u.bindAll=function(a){var b,c,d=arguments.length;if(1>=d)throw new Error("bindAll must be passed function names");for(b=1;d>b;b++)c=arguments[b],a[c]=u.bind(a[c],a);return a},u.memoize=function(a,b){var c=function(d){var e=c.cache,f=""+(b?b.apply(this,arguments):d);return u.has(e,f)||(e[f]=a.apply(this,arguments)),e[f]};return c.cache={},c},u.delay=function(a,b){var c=m.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},u.defer=u.partial(u.delay,u,1),u.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:u.now(),g=null,f=a.apply(d,e),g||(d=e=null)};return function(){var j=u.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k||k>b?(g&&(clearTimeout(g),g=null),h=j,f=a.apply(d,e),g||(d=e=null)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},u.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=u.now()-g;b>j&&j>=0?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),d||(f=e=null)))};return function(){f=this,e=arguments,g=u.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},u.wrap=function(a,b){return u.partial(b,a)},u.negate=function(a){return function(){return!a.apply(this,arguments)}},u.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}},u.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},u.before=function(a,b){var c;return function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}},u.once=u.partial(u.before,2);var G=!{toString:null}.propertyIsEnumerable("toString"),H=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];u.keys=function(a){if(!u.isObject(a))return[];if(q)return q(a);var b=[];for(var c in a)u.has(a,c)&&b.push(c);return G&&f(a,b),b},u.allKeys=function(a){if(!u.isObject(a))return[];var b=[];for(var c in a)b.push(c);return G&&f(a,b),b},u.values=function(a){for(var b=u.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},u.mapObject=function(a,b,c){b=w(b,c);for(var d,e=u.keys(a),f=e.length,g={},h=0;f>h;h++)d=e[h],g[d]=b(a[d],d,a);return g},u.pairs=function(a){for(var b=u.keys(a),c=b.length,d=Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},u.invert=function(a){for(var b={},c=u.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},u.functions=u.methods=function(a){var b=[];for(var c in a)u.isFunction(a[c])&&b.push(c);return b.sort()},u.extend=x(u.allKeys),u.extendOwn=u.assign=x(u.keys),u.findKey=function(a,b,c){b=w(b,c);for(var d,e=u.keys(a),f=0,g=e.length;g>f;f++)if(d=e[f],b(a[d],d,a))return d},u.pick=function(a,b,c){var d,e,f={},g=a;if(null==g)return f;u.isFunction(b)?(e=u.allKeys(g),d=v(b,c)):(e=E(arguments,!1,!1,1),d=function(a,b,c){return b in c},g=Object(g));for(var h=0,i=e.length;i>h;h++){var j=e[h],k=g[j];d(k,j,g)&&(f[j]=k)}return f},u.omit=function(a,b,c){if(u.isFunction(b))b=u.negate(b);else{var d=u.map(E(arguments,!1,!1,1),String);b=function(a,b){return!u.contains(d,b)}}return u.pick(a,b,c)},u.defaults=x(u.allKeys,!0),u.create=function(a,b){var c=y(a);return b&&u.extendOwn(c,b),c},u.clone=function(a){return u.isObject(a)?u.isArray(a)?a.slice():u.extend({},a):a},u.tap=function(a,b){return b(a),a},u.isMatch=function(a,b){var c=u.keys(b),d=c.length;if(null==a)return!d;for(var e=Object(a),f=0;d>f;f++){var g=c[f];if(b[g]!==e[g]||!(g in e))return!1}return!0};var I=function(a,b,c,d){if(a===b)return 0!==a||1/a===1/b;if(null==a||null==b)return a===b;a instanceof u&&(a=a._wrapped),b instanceof u&&(b=b._wrapped);var e=n.call(a);if(e!==n.call(b))return!1;switch(e){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!==+a?+b!==+b:0===+a?1/+a===1/b:+a===+b;case"[object Date]":case"[object Boolean]":return+a===+b}var f="[object Array]"===e;if(!f){if("object"!=typeof a||"object"!=typeof b)return!1;var g=a.constructor,h=b.constructor;if(g!==h&&!(u.isFunction(g)&&g instanceof g&&u.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1}c=c||[],d=d||[];for(var i=c.length;i--;)if(c[i]===a)return d[i]===b;if(c.push(a),d.push(b),f){if(i=a.length,i!==b.length)return!1;for(;i--;)if(!I(a[i],b[i],c,d))return!1}else{var j,k=u.keys(a);if(i=k.length,u.keys(b).length!==i)return!1;for(;i--;)if(j=k[i],!u.has(b,j)||!I(a[j],b[j],c,d))return!1}return c.pop(),d.pop(),!0};u.isEqual=function(a,b){return I(a,b)},u.isEmpty=function(a){return null==a?!0:C(a)&&(u.isArray(a)||u.isString(a)||u.isArguments(a))?0===a.length:0===u.keys(a).length},u.isElement=function(a){return!(!a||1!==a.nodeType)},u.isArray=p||function(a){return"[object Array]"===n.call(a)},u.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},u.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(a){u["is"+a]=function(b){return n.call(b)==="[object "+a+"]"}}),u.isArguments(arguments)||(u.isArguments=function(a){return u.has(a,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(u.isFunction=function(a){return"function"==typeof a||!1}),u.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},u.isNaN=function(a){return u.isNumber(a)&&a!==+a},u.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"===n.call(a)},u.isNull=function(a){return null===a},u.isUndefined=function(a){return void 0===a},u.has=function(a,b){return null!=a&&o.call(a,b)},u.noConflict=function(){return g._=h,this},u.identity=function(a){return a},u.constant=function(a){return function(){return a}},u.noop=function(){},u.property=z,u.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}},u.matcher=u.matches=function(a){return a=u.extendOwn({},a),function(b){return u.isMatch(b,a)}},u.times=function(a,b,c){var d=Array(Math.max(0,a));b=v(b,c,1);for(var e=0;a>e;e++)d[e]=b(e);return d},u.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},u.now=Date.now||function(){return(new Date).getTime()};var J={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},K=u.invert(J),L=function(a){var b=function(b){return a[b]},c="(?:"+u.keys(a).join("|")+")",d=RegExp(c),e=RegExp(c,"g");return function(a){return a=null==a?"":""+a,d.test(a)?a.replace(e,b):a}};u.escape=L(J),u.unescape=L(K),u.result=function(a,b,c){var d=null==a?void 0:a[b];return void 0===d&&(d=c),u.isFunction(d)?d.call(a):d};var M=0;u.uniqueId=function(a){var b=++M+"";return a?a+b:b},u.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,O={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},P=/\\|'|\r|\n|\u2028|\u2029/g,Q=function(a){return"\\"+O[a]};u.template=function(a,b,c){!b&&c&&(b=c),b=u.defaults({},b,u.templateSettings);var d=RegExp([(b.escape||N).source,(b.interpolate||N).source,(b.evaluate||N).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){return f+=a.slice(e,h).replace(P,Q),e=h+b.length,c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='"),b}),f+="';\n",b.variable||(f="with(obj||{}){\n"+f+"}\n"),f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var g=new Function(b.variable||"obj","_",f)}catch(h){throw h.source=f,h}var i=function(a){return g.call(this,a,u)},j=b.variable||"obj";return i.source="function("+j+"){\n"+f+"}",i},u.chain=function(a){var b=u(a);return b._chain=!0,b};var R=function(a,b){return a._chain?u(b).chain():b};u.mixin=function(a){u.each(u.functions(a),function(b){var c=u[b]=a[b];u.prototype[b]=function(){var a=[this._wrapped];return l.apply(a,arguments),R(this,c.apply(u,a))}})},u.mixin(u),u.each(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=i[a];u.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!==a&&"splice"!==a||0!==c.length||delete c[0],R(this,c)}}),u.each(["concat","join","slice"],function(a){var b=i[a];u.prototype[a]=function(){return R(this,b.apply(this._wrapped,arguments))}}),u.prototype.value=function(){return this._wrapped},u.prototype.valueOf=u.prototype.toJSON=u.prototype.value,u.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return u})}).call(this)},{}],4:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;h=j=i=void 0,d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;return void 0===i?void 0:i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return void 0;a=j,b=f,c=g,d=!0}},i=a("../constants"),j=d(i),k=function(a){function b(a){e(this,b),h(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a),this.legendItemStyle={height:20,paddingBottom:5},this.toggleLinkStyle={textDecoration:"none",fontWeight:"normal",cursor:"pointer",WebkitTransition:"color 500ms ease-out",MozTransition:"color 500ms ease-out",OTransition:"color 500ms ease-out",transition:"color 500ms ease-out"},this.circleStyle={display:"inline-block",width:15,height:15,borderRadius:"50%",marginTop:3,marginBottom:-2,WebkitTransition:"background-color 500ms ease-out",MozTransition:"background-color 500ms ease-out",OTransition:"background-color 500ms ease-out",transition:"background-color 500ms ease-out"},this.state={active:!0}}return f(b,a),g(b,[{key:"handleLinkClick",value:function(a){a.preventDefault();var b=!this.state.active;return this.setState({active:b}),this.props.clickCallback(this.props.type,b),!1}},{key:"render",value:function(){var a="";switch(this.props.type){case"r":a="Red";break;case"o":a="Orange";break;case"g":a="Green";break;case"b":a="Blue";break;case"p":a="Purple";break;default:a="Red"}return this.state.active?(this.toggleLinkStyle.color="#ddd",this.circleStyle.backgroundColor="#"+j.COLOUR_MAP[this.props.type].getHexString()):(this.toggleLinkStyle.color="#555",this.circleStyle.backgroundColor="#555"),React.createElement("li",{style:this.legendItemStyle,className:"series"},React.createElement("div",{style:this.toggleLinkStyle,onClick:this.handleLinkClick.bind(this),role:"checkbox","aria-checked":this.state.active},React.createElement("div",{style:this.circleStyle})," - ",a))}}]),b}(React.Component);c["default"]=k,k.propTypes={clickCallback:React.PropTypes.func.isRequired,type:React.PropTypes.string.isRequired},b.exports=c["default"]},{"../constants":7}],5:[function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(c,"__esModule",{value:!0});var g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=function(a,b,c){for(var d=!0;d;){var e=a,f=b,g=c;h=j=i=void 0,d=!1,null===e&&(e=Function.prototype);var h=Object.getOwnPropertyDescriptor(e,f);if(void 0!==h){if("value"in h)return h.value;var i=h.get;return void 0===i?void 0:i.call(g)}var j=Object.getPrototypeOf(e);if(null===j)return void 0;a=j,b=f,c=g,d=!0}},i=a("./legend-item.jsx"),j=d(i),k=function(a){function b(a){e(this,b),h(Object.getPrototypeOf(b.prototype),"constructor",this).call(this,a),this.headerStyle={fontSize:18,marginTop:0},this.listStyle={listStyleType:"none",margin:0,padding:0}}return f(b,a),g(b,[{key:"render",value:function(){var a=this.props.clickCallback;return React.createElement("div",null,React.createElement("h2",{style:this.headerStyle},"Legend"),React.createElement("ul",{style:this.listStyle},this.props.types.map(function(b){return React.createElement(j["default"],{key:b,type:b,clickCallback:a})})))}}]),b}(React.Component);c["default"]=k,k.propTypes={clickCallback:React.PropTypes.func.isRequired,types:React.PropTypes.array.isRequired},b.exports=c["default"]},{"./legend-item.jsx":4}],6:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d=a("react-tween-state"),e=React.createClass({displayName:"Progress",mixins:[d.Mixin],getInitialState:function(){return{currVal:0}},componentDidMount:function(){this._canvas||(this._canvas=this.getDOMNode(),this._context=this._canvas.getContext("2d"),this._context.beginPath(),this._context.strokeStyle=this.strokeStyle.color,this._context.lineCap="square",this._context.closePath(),this._context.fill(),this._context.lineWidth=this.strokeStyle.width,this._context.globalAlpha=.33)},componentDidUpdate:function(){this._updateProgress()},strokeStyle:{radius:25,width:5,color:"#008EAF"},canvasStyle:{display:"block"},_canvas:null,_context:null,handleProgressUpdate:function(a){var b=this,c=void 0,d=a;1===a&&(d=.99999,c=function(){b.tweenState("currVal",{endValue:0})}),this.tweenState("currVal",{endValue:d,onEnd:c})},_updateProgress:function(){if(this._context){this._context.clearRect(0,0,this._canvas.width,this._canvas.height);var a=2*this.getTweeningValue("currVal")-.5;this._context.beginPath(),this._context.arc(this.strokeStyle.radius,this.strokeStyle.radius,this.strokeStyle.radius-this.strokeStyle.width,1.5*Math.PI,Math.PI*a,!1),this._context.stroke()}},render:function(){return React.createElement("canvas",{style:this.canvasStyle,width:"50",height:"50"})}});c["default"]=e,b.exports=c["default"]},{"react-tween-state":2}],7:[function(a,b,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={r:new THREE.Color(16719360),o:new THREE.Color(16744192),b:new THREE.Color(36527),g:new THREE.Color(51765),p:new THREE.Color(14418024)};c.COLOUR_MAP=d;var e=["r","o","b","g","p"];c.COLOUR_TYPES=e;var f=.22;c.PARTICLE_SPEED=f;var g=12;c.NUM_TRAIL_PARTICLES=g;var h=.083;c.TRAIL_OPACITY_MULTIPLIER=h;var i=50;c.TRACE_LINE_VERTEX_COUNT=i;var j=.005;c.TRACE_LINE_OPACITY_LERP=j;var k=.06;c.EXPLOSION_INITIAL_LERP_FACTOR=k;var l=.001;c.EXPLOSION_INCREMENTAL_LERP=l;var m=.1;c.EXPLOSION_OPACITY_LERP=m;var n=.12;c.EXPLOSION_ROTATION_ANGLE=n;var o=100;c.MESH_POOL_SIZE=o;var p=6048e5;c.ONE_WEEK_IN_MILLIS=p;var q=3e5;c.VIZ_LOOP_LENGTH=q;var r=500;c.VIZ_POLLING_INTERVAL=r},{}],8:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){var c=new XMLHttpRequest;c.open("GET",a,!0),c.onreadystatechange=function(){if(4===c.readyState&&200===c.status){var a=JSON.parse(c.responseText);b&&b(a)}},c.send(null)}function f(a,b){e(a,b)}function g(a,b){e(a,b)}function h(a){var b=encodeURI("categories/All.json");e(b,a)}function i(a,b,c){for(var d=[],e=Object.keys(b),f=Date.now(),g=0;a>g;g++){var h=Math.floor(Math.random()*e.length),i=k.COLOUR_TYPES[Math.floor(Math.random()*k.COLOUR_TYPES.length)],j=Math.floor(Math.random()*e.length),l=Math.floor(Math.random()*k.ONE_WEEK_IN_MILLIS);h===j&&(j=j===e.length-1?0:j+1);var m={};m.src=b[e[h]],m.dest=b[e[j]],m.colour=i,m.time=new Date(f-l),d.push(m)}c(d)}Object.defineProperty(c,"__esModule",{value:!0}),c.loadWorldPins=f,c.loadCountryCodes=g,c.loadContentData=h,c.loadRandomizedContentData=i;var j=a("./constants"),k=d(j)},{"./constants":7}],9:[function(a,b,c){"use strict";function d(a,b){var c=100,d=b-90,e=Math.PI/2-a*Math.PI/180-.01*Math.PI,f=2*Math.PI-d*Math.PI/180+.06*Math.PI,g=new THREE.Vector3;return g.x=Math.sin(e)*Math.cos(f)*c,g.y=Math.cos(e)*c,g.z=Math.sin(e)*Math.sin(f)*c,g}function e(a,b){var c={};return Object.keys(a.countries).forEach(function(e){var f=a.countries[e];f.countryCode=e,f.countryName=b[e];var g=d(f.lat,f.lon);f.center=g,c[f.countryName]=f}),c}Object.defineProperty(c,"__esModule",{value:!0}),c.convertLatLonToVector=d,c.loadGeoData=e},{}],10:[function(a){"use strict";function b(a){return a&&a.__esModule?a:{"default":a}}function c(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function d(a,b){a===I.getTime()&&(K=H);var c=w.partition(K,function(c){var d=c.time.getTime();return d>=a&&b>=d});return K=c[1],c[0]}function e(){var a=r.VIZ_LOOP_LENGTH/r.VIZ_POLLING_INTERVAL,b=0,c=J.getTime()-I.getTime(),e=Math.floor(c/a),f=I.getTime();window.setInterval(function(){var c=d(f,f+e);f+=e,b++,f>=J.getTime()&&(f=I.getTime(),b=0),n.initVisualization(c),E.handleProgressUpdate(b/a)},r.VIZ_POLLING_INTERVAL)}function f(){B=new THREE.Scene,B.matrixAutoUpdate=!1;var a=new THREE.SpotLight(15658734,3);a.position.x=730,a.position.y=520,a.position.z=626,a.castShadow=!0,B.add(a);var b=new THREE.SpotLight(15658734,1.5);b.position.x=-730,b.position.y=520,b.position.z=626,b.castShadow=!0,B.add(b);var c=new THREE.PointLight(2236962,14.8);c.position.x=0,c.position.y=-750,c.position.z=0,B.add(c),z=new THREE.Object3D,B.add(z);var d=new THREE.MeshLambertMaterial({map:THREE.ImageUtils.loadTexture("images/map_outline.png")}),e=new THREE.Mesh(new THREE.SphereGeometry(100,40,40),d);e.doubleSided=!1,e.rotation.x=Math.PI,e.rotation.y=-Math.PI/2,e.rotation.z=Math.PI,z.add(e),D=new THREE.Object3D,z.add(D),A=new THREE.WebGLRenderer({antialias:!1,alpha:!0}),A.setSize(window.innerWidth,window.innerHeight),A.autoClear=!1,A.sortObjects=!1,A.generateMipmaps=!1,y.appendChild(A.domElement),C=new THREE.PerspectiveCamera(12,window.innerWidth/window.innerHeight,1,2e4),C.position.z=1400,C.position.y=0,B.add(C),x.addEventListener("mousemove",l.onDocumentMouseMove.bind(null,C),!0),x.addEventListener("mousedown",l.onDocumentMouseDown,!0),x.addEventListener("mouseup",l.onDocumentMouseUp,!1),x.addEventListener("mousewheel",l.onMouseWheel.bind(null,C),!1),x.addEventListener("DOMMouseScroll",function(a){var b=window.event||a;l.onMouseWheel(C,b)},!1),THREEx.WindowResize(A,C),l.startAutoRotate()}function g(){l.updateRotation(),z.rotation.x=l.rotateX,z.rotation.y=l.rotateY,requestAnimationFrame(g),A.render(B,C)}function h(){React.render(React.createElement(t["default"],{types:r.COLOUR_TYPES,clickCallback:n.toggleVisualizationType}),document.getElementById("legend")),E=React.render(React.createElement(v["default"],null),document.getElementById("progress"))}var i=a("./dataloading"),j=c(i),k=a("./mousekeyboard"),l=c(k),m=a("./visualize"),n=c(m),o=a("./geopins"),p=c(o),q=a("./constants"),r=c(q),s=a("./components/legend.jsx"),t=b(s),u=a("./components/progress.jsx"),v=b(u),w=a("underscore"),x=document.getElementById("visualization"),y=document.getElementById("glContainer"),z=null,A=null,B=null,C=null,D=null,E=null,F=null,G=null,H=null,I=null,J=null,K=null;Detector.webgl?(f(),n.initMeshPool(r.MESH_POOL_SIZE,D),h(),j.loadCountryCodes("country_iso3166.json",function(a){F=a,j.loadWorldPins("country_lat_lon.json",function(a){
G=a,j.loadRandomizedContentData(2e3,F,function(a){var b=w.map(a,function(a){return typeof a.time===Date?a:(a.time=new Date(a.time),a)});H=w.sortBy(b,"time"),I=H[0].time,J=H[H.length-1].time;var c=p.loadGeoData(G,F);n.buildDataVizGeometries(H,c),g(),e()})})})):Detector.addGetWebGLMessage()},{"./components/legend.jsx":5,"./components/progress.jsx":6,"./constants":7,"./dataloading":8,"./geopins":9,"./mousekeyboard":11,"./visualize":13,underscore:3}],11:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(){w&&x&&(p+=.012*(w-A),v+=.012*(x-B),Math.abs(w-A)<.1&&Math.abs(x-B)<.1&&(w=void 0,x=void 0)),c.rotateX=A+=p,c.rotateY=B+=v,p*=.98,v*=.98,(u||w)&&(p*=.6,v*=.6),-o>A&&(c.rotateX=A=-o,p*=-.95),A>o&&(c.rotateX=A=o,p*=-.95)}function f(){y=window.setInterval(function(){v+=.1*Math.PI/180*.3},100)}function g(){window.clearInterval(y)}function h(a,b){s=q,t=r,q=b.clientX-.5*window.innerWidth,r=b.clientY-.5*window.innerHeight,u&&(z.pressed("shift")?(a.position.x-=.5*(q-s),a.position.y+=.5*(r-t)):(v+=(q-s)/2*Math.PI/180*.3,p+=(r-t)/2*Math.PI/180*.3))}function i(a){-1===a.target.className.indexOf("noMapDrag")&&(u=!0,pressX=q,pressY=r,w=void 0,w=void 0,g())}function j(){u=!1,f()}function k(a,b){b.scale.z+=.1*a,b.scale.z=n.constrain(b.scale.z,.7,5)}function l(a,b){var c=0;b.wheelDelta?c=b.wheelDelta/120:b.detail&&(c=-b.detail/3),c&&k(c,a),b.returnValue=!1}Object.defineProperty(c,"__esModule",{value:!0}),c.updateRotation=e,c.startAutoRotate=f,c.stopAutoRotate=g,c.onDocumentMouseMove=h,c.onDocumentMouseDown=i,c.onDocumentMouseUp=j,c.handleMWheel=k,c.onMouseWheel=l;var m=a("./visualize_lines"),n=d(m),o=90*Math.PI/180,p=.35*Math.PI/180,q=0,r=0,s=0,t=0,u=!1,v=0,w=0,x=0,y=null,z=new THREEx.KeyboardState,A=0;c.rotateX=A;var B=0;c.rotateY=B},{"./visualize_lines":14}],12:[function(a,b,c){"use strict";function d(a,b,c){for(var d=c-b,e=a;b>e;)e+=d;return e%d}function e(a,b){var c=new THREE.Projector,d=c.projectVector(a.clone(),b),e={},f=1280>f?1280:window.innerWidth;return e.x=Math.round(d.x*(f/2))+f/2,e.y=Math.round((0-d.y)*(window.innerHeight/2))+window.innerHeight/2,e}Object.defineProperty(c,"__esModule",{value:!0}),c.wrap=d,c.screenXY=e},{}],13:[function(a,b,c){"use strict";function d(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b["default"]=a,b}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a){w.length>0?a(w.shift()):window.setTimeout(f,500,a)}function g(a){a.linesGeo.vertices=[],a.particlesGeo.vertices=[],a.pSystem.systemComplete=!1,a.explosionSphere.complete=!1,a.explosionSphere.lerpVal=r.EXPLOSION_INITIAL_LERP_FACTOR,a.explosionSphere.finalPos=null,a.explosionSphere.rotationAxis=null,a.explosionSphere.material.opacity=1,a.attributes.alpha.value=[],a.attributes.customColor.value=[],window.clearInterval(a.particleUpdateId),window.clearInterval(a.explosionUpdateId),a.vizMesh.remove(a.splineOutline),a.vizMesh.remove(a.traceLine),a.vizMesh.remove(a.explosionSphere),w.push(a)}function h(a){var b=r.COLOUR_MAP[a];return b||(b=r.COLOUR_MAP.r),b}function i(a,b){var c=document.getElementById("loading");a.forEach(function(a){var c=a.src.toUpperCase(),d=a.dest.toUpperCase(),e=b[c],f=b[d];e&&f&&(a.lineGeometry=p.makeConnectionLineGeometry(e,f))}),c.style.display="none"}function j(a,b){for(var c=0;a>c;c++)w.push(new y(b))}function k(a){return a.lineGeometry&&x[a.colour]?void f(function(b){var c=h(a.colour);b.linesGeo.merge(a.lineGeometry);var d=a.lineGeometry.vertices,e=d[0],f=e.clone();f.moveIndex=0,f.nextIndex=1,f.lerpN=0,f.path=d,b.particlesGeo.vertices.push(f),b.traceLineMat.opacity=1,b.attributes.alpha.value.push(1),b.attributes.customColor.value.push(c);for(var g=0;g<r.NUM_TRAIL_PARTICLES;g++){var i=f.clone();i.moveIndex=0,i.nextIndex=1,i.lerpN=-1*r.PARTICLE_SPEED*g,i.path=d,b.particlesGeo.vertices.push(i),b.attributes.alpha.value.push(1-r.TRAIL_OPACITY_MULTIPLIER*g),b.attributes.customColor.value.push(c)}b.explosionSphere.material.color=c,b.traceLineMat.color=c,b.attributes.alpha.needsUpdate=!0,b.attributes.customColor.needsUpdate=!0,b.vizMesh.add(b.splineOutline),b.vizMesh.add(b.traceLine),b.startParticleUpdates()}):null}function l(a){a.forEach(function(a){k(a)})}function m(a,b){x[a]=b}Object.defineProperty(c,"__esModule",{value:!0});var n=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();c.buildDataVizGeometries=i,c.initMeshPool=j,c.initParticleViz=k,c.initVisualization=l,c.toggleVisualizationType=m;var o=a("./visualize_lines"),p=d(o),q=a("./constants"),r=d(q),s=new THREE.Vector3(0,0,0),t=new THREE.Vector3(1,0,0),u=new THREE.Vector3(0,1,0),v=new THREE.Vector3(0,0,1),w=[],x={};r.COLOUR_TYPES.forEach(function(a){x[a]=!0});var y=function(){function a(b){e(this,a),this.vizMesh=b,this.particleUpdateId=null,this.explosionUpdateId=null,this.linesGeo=new THREE.Geometry,this.particlesGeo=new THREE.Geometry,this.splineOutline=new THREE.Line(null,new THREE.LineBasicMaterial({visible:!1})),this.attributes={alpha:{type:"f",value:[]},customColor:{type:"c",value:[]}},this.uniforms={color:{type:"c",value:new THREE.Color(16777215)},texture:{type:"t",value:THREE.ImageUtils.loadTexture("images/particleB.png")}},this.shaderMaterial=new THREE.ShaderMaterial({uniforms:this.uniforms,attributes:this.attributes,vertexShader:document.getElementById("vertexshader").textContent,fragmentShader:document.getElementById("fragmentshader").textContent,blending:THREE.AdditiveBlending,transparent:!0,depthTest:!0,depthWrite:!1}),this.pSystem=new THREE.PointCloud(this.particlesGeo,this.shaderMaterial),this.splineOutline.renderDepth=!1,this.pSystem.dynamic=!0,this.pSystem.systemComplete=!1,this.splineOutline.add(this.pSystem),this.splineOutline.geometry=this.linesGeo,this.traceLineMat=new THREE.LineBasicMaterial({color:16777215,opacity:1,transparent:!0}),this.traceLine=new THREE.Line(new THREE.Geometry,this.traceLineMat);for(var c=0;c<r.TRACE_LINE_VERTEX_COUNT;c++)this.traceLine.geometry.vertices.push(s.clone());var d=new THREE.MeshBasicMaterial({color:16777215,transparent:!0,opacity:1,map:THREE.ImageUtils.loadTexture("images/explosion_texture_2.png")}),f=new THREE.SphereGeometry(5,32,32);this.explosionSphere=new THREE.Mesh(f,d),this.explosionSphere.complete=!1,this.explosionSphere.lerpVal=r.EXPLOSION_INITIAL_LERP_FACTOR,this.explosionSphere.finalPos=null,this.explosionSphere.rotationAxis=null,this.explosionSphere.update=function(a){if(!this.complete){if(this.visible||(this.visible=!0),this.lerpVal<=0)return this.complete=!0,this.visible=!1,a.visible=!1,void this.dispatchEvent({type:"ExplosionComplete"});this.lerpVal-=r.EXPLOSION_INCREMENTAL_LERP,this.position.set(this.finalPos.x,this.finalPos.y,this.finalPos.z),this.position.lerp(s,this.lerpVal);for(var b=0;b<a.geometry.vertices.length&&!(b>a.slurpIndex||a.slurpIndex>=a.geometry.vertices.length);b++){var c=a.geometry.vertices[b];c.copy(a.geometry.vertices[a.slurpIndex])}a.slurpIndex++,a.geometry.verticesNeedUpdate=!0,a.material.opacity-=r.TRACE_LINE_OPACITY_LERP,this.rotateOnAxis(this.rotationAxis,r.EXPLOSION_ROTATION_ANGLE),this.lerpVal<=r.EXPLOSION_INITIAL_LERP_FACTOR/2&&(this.material.opacity-=r.EXPLOSION_OPACITY_LERP)}},this.pSystem.addEventListener("ParticleSystemComplete",this.runExplosion.bind(this)),this.explosionSphere.addEventListener("ExplosionComplete",g.bind(this,this)),this.pSystem.update=function(a){if(!this.systemComplete){this.visible||(this.visible=!0,a.visible=!0);for(var b=void 0,c=void 0,d=void 0,e=0;e<this.geometry.vertices.length;e++){b=this.geometry.vertices[e];var f=b.path;if(b.lerpN+=r.PARTICLE_SPEED,b.lerpN>1&&(b.lerpN=0,b.moveIndex=b.nextIndex,b.nextIndex++,0===e&&(a.material.opacity-=.7/f.length),b.nextIndex>=f.length))return b.moveIndex=0,b.nextIndex=0,this.systemComplete=!0,this.visible=!1,void this.dispatchEvent({type:"ParticleSystemComplete"});c=f[b.moveIndex],d=f[b.nextIndex],b.copy(c),b.lerp(d,b.lerpN)}for(var g=0;g<a.geometry.vertices.length;g++){var h=a.geometry.vertices[g];g>=b.moveIndex&&(h.copy(c),h.lerp(d,b.lerpN))}a.geometry.verticesNeedUpdate=!0,this.geometry.verticesNeedUpdate=!0}}}return n(a,[{key:"runExplosion",value:function(){var a=this.particlesGeo.vertices[0].path,b=a[a.length-2];this.traceLine.slurpIndex=0;var c=Math.floor(3*Math.random());switch(c){case 0:this.explosionSphere.rotationAxis=t;break;case 1:this.explosionSphere.rotationAxis=u;break;case 2:this.explosionSphere.rotationAxis=v}this.explosionSphere.finalPos=b.clone(),this.explosionSphere.position.set(b.x,b.y,b.z),this.explosionSphere.position.lerp(s,this.explosionSphere.lerpVal),this.explosionUpdateId=window.setInterval(this.explosionSphere.update.bind(this.explosionSphere,this.traceLine),16),this.vizMesh.add(this.explosionSphere)}},{key:"startParticleUpdates",value:function(){this.particleUpdateId=window.setInterval(this.pSystem.update.bind(this.pSystem,this.traceLine),16)}}]),a}()},{"./constants":7,"./visualize_lines":14}],14:[function(a,b,c){"use strict";function d(a,b){if(!a.countryName||!b.countryName)return void 0;var c=a.center.clone().sub(b.center).length(),d=a.center,e=b.center,g=d.clone().lerp(e,.5),h=g.length();g.normalize(),g.multiplyScalar(h+.45*c);var i=(new THREE.Vector3).subVectors(d,e);i.normalize();var j=.5*c,k=d,l=g.clone().add(i.clone().multiplyScalar(j)),m=g.clone().add(i.clone().multiplyScalar(-j)),n=e,o=new THREE.CubicBezierCurve3(d,k,l,g),p=new THREE.CubicBezierCurve3(g,m,n,e),q=2*Math.floor(.02*c+6),r=o.getPoints(q);r=r.splice(0,r.length-1),r=r.concat(p.getPoints(q)),r.push(f);var s=new THREE.Geometry;return r.forEach(function(a){s.vertices.push(a)}),s}function e(a,b,c){var d=a;return b>a?d=b:a>c&&(d=c),d}Object.defineProperty(c,"__esModule",{value:!0}),c.makeConnectionLineGeometry=d,c.constrain=e;var f=new THREE.Vector3(0,0,0)},{}]},{},[7,8,9,10,11,12,13,14,4,5,6]);